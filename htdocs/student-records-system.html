<!doctype HTML>
	<html>
		<head>
			<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
			<title>College Records Database (JS/Angular/SQL)</title>
			<link rel="stylesheet" href="/css/stylesheet.css">
			<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
			<script src = "https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular-route.min.js"></script>						
			<script type="text/javascript">	
			</script>
		</head>
		<body>
			<div ng-app="mainApp" ng-controller="studentInfoController">
				<div style="text-align:right; margin: 0 32em 0 0;">
					<p>Student ID: <input type="text" ng-model="studentInfo.studentID"/></p>
					<p>First Name: <input type="text" ng-model="studentInfo.firstName"/></p>
					<p>Last Name: <input type="text" ng-model="studentInfo.lastName"/></p>
					<p>Address: <input type="text" ng-model="studentInfo.address"/></p>
					<p>City: <input type="text" ng-model="studentInfo.city"/></p>
					<p>State/Province: <input type="text" ng-model="studentInfo.state"/></p>
					<p>Country: <input type="text" ng-model="studentInfo.country"/></p>
					<p>Phone Number: <input type="text" ng-model="studentInfo.phone"/></p>
					<p>Email: <input type="text" ng-model="studentInfo.email"/></p>
					<input type="button" value="Submit Data" ng-click="submitData()"/>
					<input type="button" value="Display Data" ng-click="retrieveData(0)"/>
					<input type="button" value="Delete Data" ng-click="retrieveData(1)"/>
					<input type="button" value="Clear Input" ng-click="clearInput('Input Cleared.')"/>
					
					<div ng-view></div>
					<div id="simple-report" style="display:none;">
						<p>{{result}}</p>
					</div>
					<div id="search-report" style="display:none;">
						<p>{{result}}</p>
						<table>
							<tr>
								<th>StudentID</th>
								<th>First Name</th>
								<th>Last Name</th>
								<th>Address</th>
								<th>City</th>
								<th>State/Province</th>
								<th>Country</th>
								<th>Phone Number:</th>
								<th>Email Address</th>
							</tr>
							<tr ng-repeat="student in result_table">
								<td>{{student.studentID}}</td>
								<td>{{student.firstName}}</td>
								<td>{{student.lastName}}</td>
								<td>{{student.address}}</td>
								<td>{{student.city}}</td>
								<td>{{student.state}}</td>
								<td>{{student.country}}</td>
								<td>{{student.phone}}</td>
								<td>{{student.email}}</td>
							</tr>
						</table>
					</div>
					
					<div id="delete-report" style="display:none;">
						<p>{{result}}</p>
						<table>
							<tr>
								<th>StudentID</th>
								<th>First Name</th>
								<th>Last Name</th>
								<th>Address</th>
								<th>City</th>
								<th>State/Province</th>
								<th>Country</th>
								<th>Phone Number:</th>
								<th>Email Address</th>
							</tr>
							<tr ng-repeat="student in result_table">
								<td>{{student.studentID}}</td>
								<td>{{student.firstName}}</td>
								<td>{{student.lastName}}</td>
								<td>{{student.address}}</td>
								<td>{{student.city}}</td>
								<td>{{student.state}}</td>
								<td>{{student.country}}</td>
								<td>{{student.phone}}</td>
								<td>{{student.email}}</td>
							</tr>
						</table>
						<input type="button" value="Confirm" ng-click="deleteData()"/>
						<input type="button" value="Cancel" ng-click="clearInput('Deletion Cancelled.')"/>
					</div>	
					
				</div>
			</div>
			
			<script>
				var mainApp = angular.module("mainApp", []);
				
				mainApp.controller('studentInfoController', function($scope, $http){
					$scope.studentInfo = {
						studentID: "",
						firstName: "",
						lastName: "",
						address: "",
						city: "",
						state: "",
						country: "",
						phone: "",
						email: ""						
					};
					
					$scope.result = "";
					$scope.result_table = "";
					
					$scope.submitData = function(){
						document.getElementById('simple-report').style.display = 'none';
						document.getElementById('search-report').style.display = 'none';
						document.getElementById('delete-report').style.display = 'none';
					
						var studentInfo = $scope.studentInfo;
						
						var data = {
							command: 0,
							studentID: studentInfo.studentID,
							firstName: studentInfo.firstName,
							lastName: studentInfo.lastName,
							address: studentInfo.address,
							city: studentInfo.city,
							state: studentInfo.state,
							country: studentInfo.country,
							phone: studentInfo.phone,
							email: studentInfo.email	
						}
						
						$http.post("php/student-info-access.php",data)
						.success(function(response) {
							$scope.result = response;
							document.getElementById('simple-report').style.display = 'flex';
						});
					};
							
					$scope.retrieveData = function(reason){
						document.getElementById('simple-report').style.display = 'none';
						document.getElementById('search-report').style.display = 'none';
						document.getElementById('delete-report').style.display = 'none';
					
						var studentInfo = $scope.studentInfo;
						var data = {
							command: 1,
							studentID: studentInfo.studentID,
							firstName: studentInfo.firstName,
							lastName: studentInfo.lastName,
							address: studentInfo.address,
							city: studentInfo.city,
							state: studentInfo.state,
							country: studentInfo.country,
							phone: studentInfo.phone,
							email: studentInfo.email	
						}
						
						$http.post("php/student-info-access.php",data)
						.success(function(response) {
							$scope.result_table = response;
							
							if(reason == 0){
								$scope.result = "Data Retrieved: ";
								document.getElementById('search-report').style.display = 'flex';
							}
							
							else if (reason == 1){
								$scope.result = "The following entries will be deleted. Would you like to continue? WARNING: Student data will also be deleted from other records!";
								document.getElementById('delete-report').style.display = 'flex';
							}
						});
					};
					
					$scope.deleteData = function(){
						document.getElementById('simple-report').style.display = 'none';
						document.getElementById('search-report').style.display = 'none';
						document.getElementById('delete-report').style.display = 'none';
						
						var studentInfo = $scope.studentInfo;
						
						var data = {
							command: 2,
							studentID: studentInfo.studentID,
							firstName: studentInfo.firstName,
							lastName: studentInfo.lastName,
							address: studentInfo.address,
							city: studentInfo.city,
							state: studentInfo.state,
							country: studentInfo.country,
							phone: studentInfo.phone,
							email: studentInfo.email
						}
						
						$http.post("php/student-info-access.php",data)
						.success(function(response) {
							$scope.result = response;
							document.getElementById('simple-report').style.display = 'flex';
						});
						
						$window.location.href = '#hideStudentInfo';
					};
					
					$scope.clearInput = function(message){
						document.getElementById('simple-report').style.display = 'none';
						document.getElementById('search-report').style.display = 'none';
						document.getElementById('delete-report').style.display = 'none';
						
						$scope.studentInfo.studentID = "";
						$scope.studentInfo.firstName = "";
						$scope.studentInfo.lastName = "";
						$scope.studentInfo.address = "";
						$scope.studentInfo.city = "";
						$scope.studentInfo.state = "";
						$scope.studentInfo.country = "";
						$scope.studentInfo.phone = "";
						$scope.studentInfo.email = "";
						
						$scope.result = message;
						
						document.getElementById('simple-report').style.display = 'flex';
					};
				});
			</script>
		</body>
	</html>